!function t(e,n,r){function i(a,s){if(!n[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};e[a][0].call(l.exports,function(t){var n=e[a][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[a].exports}for(var o="function"==typeof require&&require,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(){return x?setTimeout(i,1e3/60):(w.setTargets(),w.fire(),w.collision(),w.getUnits().forEach(function(t){t.move()}),void setTimeout(i,1e3/60))}function o(){var t={layer:v};c.renderMap(g.map,t),c.renderUnits(w.getUnits(),t),c.renderStats(w.getStats(),t),c.renderCursor(_,a({},t,w.cursorGrid(y.get()))),p(o)}var a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},s=t("./maps"),u=t("./objects"),c=t("./core/render"),l=(t("./core/utils"),t("./core/game")),f=r(l),h=t("./core/mouse"),d=r(h),g=(t("./core/constants"),s.getFirst()),p=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},m=document.querySelector("canvas"),v=m.getContext("2d"),y=d["default"](v);v.imageSmoothingEnabled=!1,m.width=640,m.height=480;var w=f["default"](g,v),x=!1,_=null;w.run(),document.addEventListener("visibilitychange",function(t){return x=document.hidden}),document.addEventListener("keyup",function(t){switch(Number(t.keyCode)){case 49:_=u.arrowTower;break;case 50:_=u.cannonTower;break;default:_=null}}),m.addEventListener("click",function(t){var e;if(_){if(e=w.cursorGrid(y.get()),!e.alowed)return;w.addUnit(_,a({},e,{layer:v}))}}),c.preloadAll(function(){i(),o()})},{"./core/constants":3,"./core/game":4,"./core/mouse":5,"./core/render":6,"./core/utils":7,"./maps":9,"./objects":13}],2:[function(t,e,n){"use strict";function r(t,e){var n=e.x,r=e.y,o=e.target;this.config=t,this.x=n,this.y=r,this.createdAt=Date.now(),this.lastShotAt=0,this.alive=!0,this.isTower="tower"===t.type,this.health=t.health,this.target=o||null,this.path=null,this.angle=o?i.getAngle(this,o):0}n.__esModule=!0;var i=t("./utils");r.prototype.setPath=function(t){this.path||(this.path=t)},r.prototype.move=function(){this.config.homing&&this.target?this.angle=i.getAngle(this,this.target):this.path&&(this.angle=i.getAngle(this,this.path[0]),i.round(this.x-this.path[0].x,5)||i.round(this.y-this.path[0].y,5)||(this.path=this.path.slice(1),this.path.length||(this.path=null))),this.x+=this.config.movementSpeed*Math.cos(this.angle),this.y+=this.config.movementSpeed*Math.sin(this.angle)},r.prototype.setTarget=function(t){this.target=t},r.prototype.takeDamage=function(t){this.health-=t,this.health<=0&&this.die()},r.prototype.fire=function(){var t=1e3/this.config.attackSpeed,e=Date.now();return this.target&&this.lastShotAt+t<e?(this.lastShotAt=e,!0):null},r.prototype.die=function(){this.alive=!1,this.health=0},n["default"]=r,e.exports=n["default"]},{"./utils":7}],3:[function(t,e,n){"use strict";n.__esModule=!0;var r=32;n.SEGMENT=r},{}],4:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){function n(){T.forEach(function(t){t.setPath([{x:5*s.SEGMENT,y:7*s.SEGMENT},{x:5*s.SEGMENT,y:4*s.SEGMENT},{x:20*s.SEGMENT,y:4*s.SEGMENT}])})}function r(t,e){var r=new a["default"](t,e);r.isTower?S.push(r):(T.push(r),n())}function i(){return S.concat(T).concat(b)}function o(){var t,e,n,r;for(t=0;t<S.length;t++){if(n=S[t],r=n.target){if(u.inRange(n,r))continue;n.setTarget(null)}for(e=0;e<T.length;e++)r=T[e],u.inRange(n,r)&&n.setTarget(r)}}function c(){var t,e;for(t=0;t<S.length;t++)e=S[t],e.fire()&&b.push(new a["default"](e.config.shot,{x:e.x,y:e.y,target:e.target,angle:u.getAngle(e,e.target),layer:e.layer}))}function l(){var t,e,n;for(t=0;t<b.length;t++)if(n=b[t],n.config.homing&&n.target&&u.inObject(n,n.target))f(n,n.target);else if(!n.config.homing)for(e=0;e<T.length;e++)if(u.inObject(n,T[e])){f(n,T[e]);break}for(d(),t=0;t<T.length;t++)u.inObject(T[t],k)||(x--,T[t].die());d()}function f(t,e){var n;if(t.config.splash)for(n=0;n<T.length;n++)u.inSplash(t,T[n])&&h(t,T[n]);else h(t,e);t.die()}function h(t,e){e.takeDamage(t.config.damage)}function d(){var t,e=[];for(t=0;t<T.length;t++)T[t].alive?e.push(T[t]):g(T[t]);b=b.filter(function(t){return t.alive}),T=e}function g(t){var e;for(e=0;e<S.length;e++)S[e].target===t&&S[e].setTarget(null);M--,M||(w++,setTimeout(m,5e3))}function p(t){var e=t.x,n=t.y;e=u.round(e,s.SEGMENT),n=u.round(n,s.SEGMENT);var r,i=T.concat(S),o={x:e,y:n};for(r=0;r<i.length;r++)if(u.inObject(o,i[r]))return{x:e,y:n,alowed:!1};return{x:e,y:n,alowed:!0}}function m(){function e(){i>=n.count||(r(n.unit,{x:t.spawn.x*s.SEGMENT,y:t.spawn.y*s.SEGMENT}),i++,setTimeout(e,u.random(o,3*o)))}if(w>=t.waves.length)return console.log("END GAME");var n=t.waves[w],i=0,o=1e4/n.count;M=n.count,e()}function v(){m()}function y(){return{wave:w+1,lives:x,score:E,gold:_,unitsInWave:M}}var w=0,x=t.lives,_=t.gold,E=0,M=0,S=[],T=[],b=[],k={x:0,y:0,config:{width:t.size.width*s.SEGMENT,height:t.size.height*s.SEGMENT}};return{addUnit:r,getUnits:i,setTargets:o,fire:c,collision:l,cursorGrid:p,run:v,getStats:y}}n.__esModule=!0,n["default"]=i;var o=t("./Unit"),a=r(o),s=t("./constants"),u=t("./utils");e.exports=n["default"]},{"./Unit":2,"./constants":3,"./utils":7}],5:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]=function(t){var e=0,n=0;return t.canvas.addEventListener("mousemove",function(t){e=t.clientX,n=t.clientY}),{get:function(){return{x:e,y:n}}}},e.exports=n["default"]},{}],6:[function(t,e,n){"use strict";function r(t,e){function n(){var e=u/t.health;o.imageSmoothingEnabled=!1,o.drawImage(f,r,i,t.width,t.height),o.globalAlpha=1,"health"in t&&(o.fillStyle="#00FF00",o.fillRect(r,i,t.width,2),o.fillStyle="#FF0000",o.fillRect(r+e*t.width,i,(1-e)*t.width,2))}var r=e.x,i=e.y,o=e.layer,a=e.time,s=void 0===a?0:a,u=e.health,c=~~((Date.now()-s)/h)%t.textures.length,l=t.textures[c],f=g[l];f||(f=g[l]=new Image,f.src=l,f.loads=[],f.onload=function(){f.loads.forEach(function(t){return t()})}),f.complete?n():f.loads.push(n)}function i(t,e){var n=e.layer;t.forEach(function(t,e){t.forEach(function(t,i){var o={x:f.SEGMENT*i,y:f.SEGMENT*e,layer:n};r(t,o)})})}function o(t,e){var n=e.x,i=e.y,o=e.layer,a=e.alowed;t&&(o.globalAlpha=.4,o.fillStyle=a?"#00FF00":"#FF0000",o.fillRect(n,i,f.SEGMENT,f.SEGMENT),r(t,{layer:o,x:n,y:i}))}function a(t,e){var n=e.layer;t.forEach(function(t){r(t.config,{layer:n,x:t.x,y:t.y,health:t.health,time:t.createdAt})})}function s(t,e){var n=e.layer,r=e.x,i=e.y;n.strokeStyle="black",n.font="16px monaco",n.lineWidth=4,n.strokeText(t,r,i),n.fillStyle="white",n.fillText(t,r,i)}function u(t,e){var n=e.layer;s("wave:  "+t.wave,{x:10,y:20,layer:n}),s("lives: "+t.lives,{x:10,y:40,layer:n}),s("gold:  "+t.gold,{x:10,y:60,layer:n}),s("score: "+t.score,{x:10,y:80,layer:n}),s("Use 1 or 2 to build the tower",{x:140,y:20,layer:n})}function c(t,e){var n=t.reduce(function(t,e){return t.concat(e.textures)},[]).filter(Boolean);Promise.all(n.map(function(t){return new Promise(function(e){var n=new Image;g[t]=n,n.onload=e,n.loads=[],n.src=t})})).then(e)}function l(t){var e=Object.keys(d).map(function(t){return d[t]});return c(e,t)}n.__esModule=!0,n.render=r,n.renderMap=i,n.renderCursor=o,n.renderUnits=a,n.renderStats=u,n.preload=c,n.preloadAll=l;var f=t("./constants"),h=300,d=t("../objects"),g=[]},{"../objects":13,"./constants":3}],7:[function(t,e,n){"use strict";function r(t,e){return c(e.x-t.x)+c(e.y-t.y)<c(t.config.range)}function i(t,e){var n=e.x-t.x,r=e.y-t.y,i=Math.atan(r/n);return 0>n&&(i=Math.PI+i),i}function o(t,e){var n=t.config?t.config.width/2:0,r=t.config?t.config.height/2:0;return t.x>=e.x-n&&t.x<e.x+e.config.width+n&&t.y>=e.y-r&&t.y<e.y+e.config.height+r}function a(t,e){return c(t.x-e.x-e.config.width)+c(t.y-e.y-e.config.height)<c(t.config.splash)}function s(t,e){return Math.round(Math.random()*(e-t))+t}function u(t,e){return t-t%e}n.__esModule=!0,n.inRange=r,n.getAngle=i,n.inObject=o,n.inSplash=a,n.random=s,n.round=u;var c=(Math.sqrt,function(t){return t*t})},{}],8:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={lives:3,gold:100,size:{width:20,height:15},spawn:{x:0,y:7},finish:{x:20,y:4},waves:[[1,10],[1,20]],map:"\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	11111000000000000000\n	11111011111111111112\n	11111011111111111112\n	00000011111111111112\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	11111111111111111112\n	"},e.exports=n["default"]},{}],9:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){return t.split("\n").filter(Boolean).map(function(t){return t.trim().split("").map(Number).map(function(t){return f[t]})})}function o(t){return t.map(function(t){return{unit:h[t[0]],count:t[1]}})}function a(){var t=c["default"];return s({},t,{map:i(t.map),waves:o(t.waves)})}n.__esModule=!0;var s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};n.getFirst=a;var u=t("./first"),c=r(u),l=t("../objects"),f={0:l.sand,1:l.grass,2:l.rock},h={1:l.unit}},{"../objects":13,"./first":8}],10:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={name:"Arrow Tower",type:"tower",textures:["images/tower_1_2.png"],width:32,height:32,movementSpeed:0,attackSpeed:2,range:250,shot:{textures:["images/shot_1.png"],damage:10,homing:!0,movementSpeed:4,width:10,height:10}},e.exports=n["default"]},{}],11:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={name:"Cannon Tower",type:"tower",textures:["images/tower_2_1.png"],width:32,height:32,movementSpeed:0,attackSpeed:1,range:250,shot:{textures:["images/shot_2.png"],damage:30,homing:!1,splash:30,movementSpeed:1.5,width:10,height:10}},e.exports=n["default"]},{}],12:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={name:"Grass",textures:["images/grass_1.png"],width:32,height:32},e.exports=n["default"]},{}],13:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}n.__esModule=!0;var i=t("./grass"),o=r(i);n.grass=o["default"];var a=t("./sand"),s=r(a);n.sand=s["default"];var u=t("./rock"),c=r(u);n.rock=c["default"];var l=t("./arrowTower"),f=r(l);n.arrowTower=f["default"];var h=t("./cannonTower"),d=r(h);n.cannonTower=d["default"];var g=t("./unit"),p=r(g);n.unit=p["default"]},{"./arrowTower":10,"./cannonTower":11,"./grass":12,"./rock":14,"./sand":15,"./unit":16}],14:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={name:"Rock",textures:["images/rock.png"],width:32,height:32},e.exports=n["default"]},{}],15:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={name:"Sand",textures:["images/sand.png"],width:32,height:32},e.exports=n["default"]},{}],16:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]={name:"Unit",type:"unit",textures:["images/unit_1_1.png","images/unit_1_2.png"],width:20,height:36,movementSpeed:1,health:100,damage:0},e.exports=n["default"]},{}]},{},[1]);